<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Graficzny interfejs użytkownika cz.2 &mdash; Java krok po kroku 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Java krok po kroku 1.0 documentation" href="index.html" />
    <link rel="next" title="Praktyczna aplikacja" href="summary.html" />
    <link rel="prev" title="Graficzny interfejs użytkownika" href="gui.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="summary.html" title="Praktyczna aplikacja"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="gui.html" title="Graficzny interfejs użytkownika"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Java krok po kroku 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="graficzny-interfejs-uzytkownika-cz-2">
<h1>Graficzny interfejs użytkownika cz.2<a class="headerlink" href="#graficzny-interfejs-uzytkownika-cz-2" title="Permalink to this headline">¶</a></h1>
<p>W tej lekcji dowiesz się:</p>
<ul class="simple">
<li>w jaki sposó obsługiwać zdarzenia przycisków</li>
<li>jak dodać dodać obsługę zdarzeń myszy lub klawiatury</li>
<li>czym są klasy anonimowe</li>
</ul>
<div class="section" id="obsluga-zdarzen">
<h2>Obsługa zdarzeń<a class="headerlink" href="#obsluga-zdarzen" title="Permalink to this headline">¶</a></h2>
<p>W poprzedniej lekcji dowiedziałeś się w jaki sposób stworzyć prosty graficzny interfejs użytkownika korzystając z Javy FX, na czym polega architektura MVC i jak powiązać kontrolki zdefiniowane w pliku fxml ze zmiennymi w klasie kontrolera, a także jak z poziomu kodu Javy ustawiać ich właściwości na przykładzie metody <em>setText()</em>.</p>
<p>Problemem jest jednak to, że zdefiniowane menu nawigacyjne nie reaguje w żaden sposób na akcje wykonywane przez użytkownika, zliczanie słów oraz wyrazów także jest zakodowane na sztywno i nie reaguje na to co użytkownik wprowadza do pola tekstowego.</p>
<p>Rozwiązaniem tych problemów jest podpięcie pod poszczególne z kontrolek odpowiednich zdarzeń, które w odpowiedzi wykonają pewną akcję. Istnieje kilka metod na realizację tego zadania, jednak my skupimy się na dwóch.</p>
</div>
<div class="section" id="podpiecie-zdarzen-przyciskow">
<h2>Podpięcie zdarzeń przycisków<a class="headerlink" href="#podpiecie-zdarzen-przyciskow" title="Permalink to this headline">¶</a></h2>
<p>Jednymi z najczęściej powtarzających się opcji w niemal każdej aplikacji jest odpowiedź aplikacji na akcję użytkownika polegającą na wciśnięcie zwykłęgo przycisku (w JavieFX reprezentowany przez klasę Button). W naszym przykładowym programie nie posiadamy na tę chwilę żadnego przycisku, jednak nic nie stoi na przeszkodzie, żeby go dodać.</p>
<p><em>hierarchia Editor.fxml</em></p>
<img alt="_images/button-hierarchy.png" class="align-center" src="_images/button-hierarchy.png" />
<p><em>plik Editor.fxml</em></p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="cp">&lt;?import javafx.scene.control.*?&gt;</span>
<span class="cp">&lt;?import java.lang.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.BorderPane?&gt;</span>

<span class="nt">&lt;BorderPane</span> <span class="na">xmlns=</span><span class="s">&quot;http://javafx.com/javafx/8&quot;</span> <span class="na">xmlns:fx=</span><span class="s">&quot;http://javafx.com/fxml/1&quot;</span>
    <span class="na">fx:controller=</span><span class="s">&quot;application.EditorController&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;top&gt;</span>
        <span class="nt">&lt;MenuBar</span> <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;menus&gt;</span>
                <span class="nt">&lt;Menu</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;File&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;items&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Close&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/items&gt;</span>
                <span class="nt">&lt;/Menu&gt;</span>
                <span class="nt">&lt;Menu</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Edit&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;items&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Delete&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/items&gt;</span>
                <span class="nt">&lt;/Menu&gt;</span>
                <span class="nt">&lt;Menu</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Help&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;items&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;About&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/items&gt;</span>
                <span class="nt">&lt;/Menu&gt;</span>
            <span class="nt">&lt;/menus&gt;</span>
        <span class="nt">&lt;/MenuBar&gt;</span>
    <span class="nt">&lt;/top&gt;</span>
    <span class="nt">&lt;center&gt;</span>
        <span class="nt">&lt;TextArea</span> <span class="na">fx:id=</span><span class="s">&quot;mainTextArea&quot;</span> <span class="na">prefHeight=</span><span class="s">&quot;400.0&quot;</span> <span class="na">prefWidth=</span><span class="s">&quot;500.0&quot;</span>
            <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/center&gt;</span>
    <span class="nt">&lt;bottom&gt;</span>
        <span class="nt">&lt;HBox</span> <span class="na">alignment=</span><span class="s">&quot;CENTER_LEFT&quot;</span> <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;children&gt;</span>
                <span class="nt">&lt;Label</span> <span class="na">fx:id=</span><span class="s">&quot;lettersCountLabel&quot;</span> <span class="na">text=</span><span class="s">&quot;Label&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Separator</span> <span class="na">orientation=</span><span class="s">&quot;VERTICAL&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Label</span> <span class="na">fx:id=</span><span class="s">&quot;wordsCountLabel&quot;</span> <span class="na">text=</span><span class="s">&quot;Label&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Separator</span> <span class="na">orientation=</span><span class="s">&quot;VERTICAL&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Button</span> <span class="na">fx:id=</span><span class="s">&quot;clearButton&quot;</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Clear&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/children&gt;</span>
        <span class="nt">&lt;/HBox&gt;</span>
    <span class="nt">&lt;/bottom&gt;</span>
<span class="nt">&lt;/BorderPane&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Przycisk dodaliśmy w dolnej części aplikacji ustawiając na nim domyślny tekst &#8220;Clear&#8221; oraz nadając fx:id <em>clearButton</em> - posłuży on nam do wyczyszczenia zawartości pola tekstowego.</p>
<p>Musimy także zdefiniować zmienną odpowiadającą fx:id przycisku w klasie kontrolera, abyśmy mogli dodać do niego obsługę zdarzenia. Robimy to używając adnotacji &#64;FXML i nazwy zmiennej zgodnej z fx:id.</p>
<p><em>plik EditorController.java</em></p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">package</span> <span class="n">application</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ResourceBundle</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javafx.fxml.FXML</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.fxml.Initializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.Button</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.Label</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.TextArea</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EditorController</span> <span class="kd">implements</span> <span class="n">Initializable</span> <span class="o">{</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">TextArea</span> <span class="n">mainTextArea</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Label</span> <span class="n">wordsCountLabel</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Label</span> <span class="n">lettersCountLabel</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Button</span> <span class="n">clearButton</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">URL</span> <span class="n">arg0</span><span class="o">,</span> <span class="n">ResourceBundle</span> <span class="n">arg1</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">mainText</span> <span class="o">=</span> <span class="s">&quot;To jest długi tekst,\n&quot;</span>
                <span class="o">+</span> <span class="s">&quot;który zostanie wyświetlony\n&quot;</span>
                <span class="o">+</span> <span class="s">&quot;w głównym oknie aplikacji&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">letters</span> <span class="o">=</span> <span class="s">&quot;Ilość liter: 50&quot;</span><span class="o">;</span>
        <span class="n">String</span> <span class="n">words</span> <span class="o">=</span> <span class="s">&quot;Ilość słów: 12&quot;</span><span class="o">;</span>

        <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">mainText</span><span class="o">);</span>
        <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">letters</span><span class="o">);</span>
        <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">words</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Jak widzisz wszystko robimy analogicznie jak w poprzedniej lekcji, czyli:</p>
<ol class="arabic simple">
<li>Dodajemy kontrolkę do pliku fxml w Scene Builderze.</li>
<li>Nadajemy jej odpowiednie fx:id.</li>
<li>Tworzymy zmienną odpowiadającą fx:id w klasie kontrolera oznaczając ją jednocześnie adnotacją &#64;FXML.</li>
</ol>
</div>
<div class="section" id="obsluga-zdarzenia-przycisku">
<h2>Obsługa zdarzenia przycisku<a class="headerlink" href="#obsluga-zdarzenia-przycisku" title="Permalink to this headline">¶</a></h2>
<p>Obsługa zdarzenia przycisku jest najłatwiejszą z tych, które poznamy. Jest to czynność tak często powtarzana, że przycisk (klasa Button) posiada specjalną metodę dedykowaną do tego celu o nazwie <strong>setOnAction()</strong>. Podpięcie akcji przycisku najlepiej jest zrealizować w metodzie initialize(), która będzie wywołana przy uruchamianiu aplikacji.</p>
<p><em>plik EditorController.java (metoda initialize())</em></p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">URL</span> <span class="n">arg0</span><span class="o">,</span> <span class="n">ResourceBundle</span> <span class="n">arg1</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">//reszta kodu bez zmian</span>
    <span class="n">clearButton</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//kod obsługi zdarzenia</span>
            <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">});</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>Jak widzisz na przycisku wywołaliśmy metodę <strong>setOnAction()</strong>, w której utworzyliśmy obiekt <strong>EventHandler</strong> z parametrem <strong>ActionEvent</strong>. Problem polega na tym, że jeśli pzyjrzysz się temu kodowi bliżej, to zauważysz, że występuje tutaj dziwne zagnieżdżenie nawiasów, a dodatkowo gdzieś podczas tworzenia obiektu implementujemy jeszcze metodę <strong>handle()</strong>. Jest to spowodowane tym, że EventHandler jest tak naprawdę interfejsem, a to oznacza, że nie możemy utworzyć obiektu na jego podstawie. Rozwiązaniem jest utworzenie <strong>anonimowej klasy wewnętrznej</strong>, czyli takiej klasy, która implementuje interfejs EventHandler i nie posiada swojej nazwy. ActionEvent jest typem zdarzenia jakie chcemy obsłużyć - w tym przypadku odpowiada ono wciśnięciu przycisku.</p>
<p>W metodzie <em>handle()</em> możemy zamieścić kod obsługi zdarzenia, czyli wywołać odpowiednie metody, ustawić tekst w innych kontrolkach itp. W naszym przypadku przycisk ma wyczyścić pole tekstowe - wywołujemy więc metodę <em>mainTextArea.setText(&#8220;&#8221;);</em> co oznacza ustawienie pustego Stringa jako jej zawartości.</p>
<p><strong>Uruchom aplikację i przetestuj działanie zaimplementowanego zdarzenia przycisku</strong>.</p>
<p><strong>Porada</strong></p>
<p>Pisanie kodu klasy anonimowej byłoby dosyć męczące, szczególnie biorąc pod uwagę nagromadzenie nawiasów i zagnieżdżeń kodu. Na szczęście większość kodu można wygenerować półautomatycznie.</p>
<p>Krok 1 - wpisz po prostu &#8220;clearButton.setOna...&#8221; i Ctrl+Spacja</p>
<img alt="_images/step1.png" class="align-center" src="_images/step1.png" />
<p>Krok 2 - zacznij wpisywać &#8220;new EventHandler&#8221; i Ctrl+Spacja</p>
<img alt="_images/step2.png" class="align-center" src="_images/step2.png" />
<p>Krok 3 - wciśnij Ctrl+1 i wybierz opcję &#8220;add unimplemented methods&#8221;</p>
<img alt="_images/step3.png" class="align-center" src="_images/step3.png" />
</div>
<div class="section" id="obsluga-zdarzen-klawiatury-i-myszy">
<h2>Obsługa zdarzeń klawiatury i myszy<a class="headerlink" href="#obsluga-zdarzen-klawiatury-i-myszy" title="Permalink to this headline">¶</a></h2>
<p>Obsługa zdarzeń przycisków jest prosta - wystarczy zapamiętać jedną metodę <em>setOnAction()</em> oraz sposób tworzenia klasy anonimowej - praktycznie nic się tam nie zmienia. Jeżeli jednak chcemy obsłużyć zdarzenia klawiatury, czy myszy (wciskanie przycisków, ruch kursora) musimy skorzystać z innej metody. W naszym edytorze tekstu chcemy mieć funkcjonalność zliczania znaków oraz słów. W tym celu zdarzenie należy podpiąć pod obiekt typu <strong>TextArea</strong> jednak tym razem posłużymy się metodą <strong>addEventFilter()</strong>.</p>
<p><em>plik EditorController.java (metoda initialize())</em></p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">URL</span> <span class="n">arg0</span><span class="o">,</span> <span class="n">ResourceBundle</span> <span class="n">arg1</span><span class="o">)</span> <span class="o">{</span>

    <span class="kd">final</span> <span class="n">String</span> <span class="n">lettersCount</span> <span class="o">=</span> <span class="s">&quot;Ilość znaków: &quot;</span><span class="o">;</span>
    <span class="kd">final</span> <span class="n">String</span> <span class="n">wordsCount</span> <span class="o">=</span> <span class="s">&quot;Ilość słów: &quot;</span><span class="o">;</span>

    <span class="c1">//domyślne etykiety ustawione na 0</span>
    <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>
    <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>

    <span class="n">clearButton</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//kod obsługi zdarzenia</span>
            <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>

            <span class="c1">//po wciśnięciu przycisku zmieniamy tekst etykiet na domyślny</span>
            <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>
            <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">});</span>

    <span class="n">mainTextArea</span><span class="o">.</span><span class="na">addEventFilter</span><span class="o">(</span><span class="n">KeyEvent</span><span class="o">.</span><span class="na">KEY_TYPED</span><span class="o">,</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">KeyEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">KeyEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//licznik znaków z pominięciem spacji</span>
            <span class="kt">int</span> <span class="n">letters</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">trim</span><span class="o">().</span><span class="na">length</span><span class="o">();</span>
            <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="n">letters</span><span class="o">);</span>

            <span class="c1">//licznik słów</span>
            <span class="kt">int</span> <span class="n">words</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">).</span><span class="na">length</span><span class="o">;</span>
            <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="n">words</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">});</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
<p>W wierszu 23 dodaliśmy zdarzenie do obiektu mainTextArea. Metodzie addEventFilter należy przekazać dwa argumenty:</p>
<ul class="simple">
<li>typ zdarzenia jakie chcemy obsłużyć - u nas jest to KeyEvent.KEY_TYPED co odpowiada wciśnięciu i zwolnieniu dowolnego klawisza klawiatury</li>
<li>obiekt EventHandler (podobnie jak w metodzie setOnAction), jednak z parametrem generycznym zgodnym z typem zdarzenia - w naszym przypadku typem tym jest KeyEvent.</li>
</ul>
<p>W wierszach 26-32 definiujemy co ma się stać po wciśnięciu dowolnego klawisza. Liczbę znaków zliczamy usuwając najpierw białe znaki metodą <em>trim()</em> z klasy String, a następnie pobierając długość takiego napisu metodą <em>length()</em>. Ilość słów zliczamy podobnie, jednak najpierw pobrany tekst dzielimy na jednowymiarową tablicę słów, które były rozdzielone znakiem spacji &#8221; &#8221;. Właściwość length tablicy jest więc równa ilości słów w naszym tekście.</p>
<p>Teksty etykiet (Label) podobnie jak to było z obiektem TextArea ustawiamy za pomocą metody <em>setText()</em>.</p>
<p>Dostępne zdarzenia klawiatury, które możemy obsługiwać to:</p>
<ul class="simple">
<li>KeyEvent.KEY_PRESSED - wciśnięcie klawisza</li>
<li>KeyEvent.KEY_RELEASED - zwolnienie klawisza</li>
<li>KeyEvent.KEY_TYPED - wciśnięcie i zwolnienie klawisza</li>
</ul>
<p>Jeżeli chcielibyśmy obsłużyć zdarzenia myszy, zrobimy to bardzo podobnie, jednak wykorzystamy klasę MouseEvent. Wybrane typy zdarzeń:</p>
<ul class="simple">
<li>MouseEvent.MOUSE_CLICKED - wciśnięcie i zwolnienie przycisku myszy</li>
<li>MouseEvent.MOUSE_ENTERED - najechanie kursorem nad daną kontrolkę, do którego podpięte jest zdarzenie</li>
<li>MouseEvent.MOUSE_DRAGGED - przeciągnięcie myszy z wciśniętym przyciskiem myszy</li>
</ul>
<p>Metodę <em>addEventFilter()</em> można wywołać na niemal dowolnym obiekcie JavyFX, więc w identyczny sposób można obsługiwać zdarzenia pól tekstowych, etykie, buttonów, czy też menu.</p>
</div>
<div class="section" id="cwiczenie">
<h2>Ćwiczenie<a class="headerlink" href="#cwiczenie" title="Permalink to this headline">¶</a></h2>
<p>Dodaj do programu następujące opcje:</p>
<ul class="simple">
<li>Exit z menu File, które powoduje zamknięcie aplikacji. Aplikację JavyFX można zakończyć wywołując metodę <em>Platform.exit()</em></li>
<li>Big Letters / Small Letters w menu Edit - opcje powodujące podmianę tekstu na wielkie lub małe litery</li>
</ul>
<img alt="_images/zad1.png" class="align-center" src="_images/zad1.png" />
<p><em>plik Editor.fxml</em></p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>

<span class="cp">&lt;?import javafx.scene.control.*?&gt;</span>
<span class="cp">&lt;?import java.lang.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.*?&gt;</span>
<span class="cp">&lt;?import javafx.scene.layout.BorderPane?&gt;</span>

<span class="nt">&lt;BorderPane</span> <span class="na">xmlns=</span><span class="s">&quot;http://javafx.com/javafx/8&quot;</span> <span class="na">xmlns:fx=</span><span class="s">&quot;http://javafx.com/fxml/1&quot;</span>
    <span class="na">fx:controller=</span><span class="s">&quot;application.EditorController&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;top&gt;</span>
        <span class="nt">&lt;MenuBar</span> <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;menus&gt;</span>
                <span class="nt">&lt;Menu</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;File&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;items&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">fx:id=</span><span class="s">&quot;closeMenuItem&quot;</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span>
                            <span class="na">text=</span><span class="s">&quot;Close&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/items&gt;</span>
                <span class="nt">&lt;/Menu&gt;</span>
                <span class="nt">&lt;Menu</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Edit&quot;</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;items&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">fx:id=</span><span class="s">&quot;bigMenuItem&quot;</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span>
                            <span class="na">text=</span><span class="s">&quot;BIG LETTERS&quot;</span> <span class="nt">/&gt;</span>
                        <span class="nt">&lt;MenuItem</span> <span class="na">fx:id=</span><span class="s">&quot;smallMenuItem&quot;</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span>
                            <span class="na">text=</span><span class="s">&quot;small letters&quot;</span> <span class="nt">/&gt;</span>
                    <span class="nt">&lt;/items&gt;</span>
                <span class="nt">&lt;/Menu&gt;</span>
            <span class="nt">&lt;/menus&gt;</span>
        <span class="nt">&lt;/MenuBar&gt;</span>
    <span class="nt">&lt;/top&gt;</span>
    <span class="nt">&lt;center&gt;</span>
        <span class="nt">&lt;TextArea</span> <span class="na">fx:id=</span><span class="s">&quot;mainTextArea&quot;</span> <span class="na">prefHeight=</span><span class="s">&quot;400.0&quot;</span> <span class="na">prefWidth=</span><span class="s">&quot;500.0&quot;</span>
            <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span> <span class="nt">/&gt;</span>
    <span class="nt">&lt;/center&gt;</span>
    <span class="nt">&lt;bottom&gt;</span>
        <span class="nt">&lt;HBox</span> <span class="na">alignment=</span><span class="s">&quot;CENTER_LEFT&quot;</span> <span class="na">BorderPane.alignment=</span><span class="s">&quot;CENTER&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;children&gt;</span>
                <span class="nt">&lt;Label</span> <span class="na">fx:id=</span><span class="s">&quot;lettersCountLabel&quot;</span> <span class="na">text=</span><span class="s">&quot;Label&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Separator</span> <span class="na">orientation=</span><span class="s">&quot;VERTICAL&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Label</span> <span class="na">fx:id=</span><span class="s">&quot;wordsCountLabel&quot;</span> <span class="na">text=</span><span class="s">&quot;Label&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Separator</span> <span class="na">orientation=</span><span class="s">&quot;VERTICAL&quot;</span> <span class="nt">/&gt;</span>
                <span class="nt">&lt;Button</span> <span class="na">fx:id=</span><span class="s">&quot;clearButton&quot;</span> <span class="na">mnemonicParsing=</span><span class="s">&quot;false&quot;</span> <span class="na">text=</span><span class="s">&quot;Clear&quot;</span> <span class="nt">/&gt;</span>
            <span class="nt">&lt;/children&gt;</span>
        <span class="nt">&lt;/HBox&gt;</span>
    <span class="nt">&lt;/bottom&gt;</span>
<span class="nt">&lt;/BorderPane&gt;</span>
</pre></div>
</td></tr></table></div>
<p><em>plik EditorCntroller.java</em></p>
<div class="highlight-java"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">package</span> <span class="n">application</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.net.URL</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.ResourceBundle</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javafx.application.Platform</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.event.ActionEvent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.event.EventHandler</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.fxml.FXML</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.fxml.Initializable</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.Button</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.Label</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.MenuItem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.control.TextArea</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javafx.scene.input.KeyEvent</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">EditorController</span> <span class="kd">implements</span> <span class="n">Initializable</span> <span class="o">{</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">TextArea</span> <span class="n">mainTextArea</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Label</span> <span class="n">wordsCountLabel</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Button</span> <span class="n">clearButton</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">Label</span> <span class="n">lettersCountLabel</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">MenuItem</span> <span class="n">closeMenuItem</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">MenuItem</span> <span class="n">bigMenuItem</span><span class="o">;</span>

    <span class="nd">@FXML</span>
    <span class="kd">private</span> <span class="n">MenuItem</span> <span class="n">smallMenuItem</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="o">(</span><span class="n">URL</span> <span class="n">arg0</span><span class="o">,</span> <span class="n">ResourceBundle</span> <span class="n">arg1</span><span class="o">)</span> <span class="o">{</span>

        <span class="kd">final</span> <span class="n">String</span> <span class="n">lettersCount</span> <span class="o">=</span> <span class="s">&quot;Ilość znaków: &quot;</span><span class="o">;</span>
        <span class="kd">final</span> <span class="n">String</span> <span class="n">wordsCount</span> <span class="o">=</span> <span class="s">&quot;Ilość słów: &quot;</span><span class="o">;</span>

        <span class="c1">//domyślne etykiety ustawione na 0</span>
        <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>
        <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>

        <span class="n">clearButton</span><span class="o">.</span><span class="na">setOnAction</span><span class="o">(</span><span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">arg0</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//kod obsługi zdarzenia</span>
                <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;&quot;</span><span class="o">);</span>

                <span class="c1">//po wciśnięciu przycisku zmieniamy tekst etykiet na domyślny</span>
                <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>
                <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="mi">0</span><span class="o">);</span>

            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">mainTextArea</span><span class="o">.</span><span class="na">addEventFilter</span><span class="o">(</span><span class="n">KeyEvent</span><span class="o">.</span><span class="na">KEY_TYPED</span><span class="o">,</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">KeyEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">KeyEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//licznik znaków z pominięciem spacji</span>
                <span class="kt">int</span> <span class="n">letters</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">trim</span><span class="o">().</span><span class="na">length</span><span class="o">();</span>
                <span class="n">lettersCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">lettersCount</span> <span class="o">+</span> <span class="n">letters</span><span class="o">);</span>

                <span class="c1">//licznik słów</span>
                <span class="kt">int</span> <span class="n">words</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">split</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">).</span><span class="na">length</span><span class="o">;</span>
                <span class="n">wordsCountLabel</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">wordsCount</span> <span class="o">+</span> <span class="n">words</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">closeMenuItem</span><span class="o">.</span><span class="na">addEventHandler</span><span class="o">(</span><span class="n">ActionEvent</span><span class="o">.</span><span class="na">ACTION</span><span class="o">,</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">//zamknięcie aplikacji</span>
                <span class="n">Platform</span><span class="o">.</span><span class="na">exit</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">bigMenuItem</span><span class="o">.</span><span class="na">addEventHandler</span><span class="o">(</span><span class="n">ActionEvent</span><span class="o">.</span><span class="na">ACTION</span><span class="o">,</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="na">toUpperCase</span><span class="o">();</span>
                <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="n">smallMenuItem</span><span class="o">.</span><span class="na">addEventHandler</span><span class="o">(</span><span class="n">ActionEvent</span><span class="o">.</span><span class="na">ACTION</span><span class="o">,</span> <span class="k">new</span> <span class="n">EventHandler</span><span class="o">&lt;</span><span class="n">ActionEvent</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">handle</span><span class="o">(</span><span class="n">ActionEvent</span> <span class="n">event</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">text</span> <span class="o">=</span> <span class="n">mainTextArea</span><span class="o">.</span><span class="na">getText</span><span class="o">();</span>
                <span class="n">text</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="na">toLowerCase</span><span class="o">();</span>
                <span class="n">mainTextArea</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="n">text</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Graficzny interfejs użytkownika cz.2</a><ul>
<li><a class="reference internal" href="#obsluga-zdarzen">Obsługa zdarzeń</a></li>
<li><a class="reference internal" href="#podpiecie-zdarzen-przyciskow">Podpięcie zdarzeń przycisków</a></li>
<li><a class="reference internal" href="#obsluga-zdarzenia-przycisku">Obsługa zdarzenia przycisku</a></li>
<li><a class="reference internal" href="#obsluga-zdarzen-klawiatury-i-myszy">Obsługa zdarzeń klawiatury i myszy</a></li>
<li><a class="reference internal" href="#cwiczenie">Ćwiczenie</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="gui.html"
                        title="previous chapter">Graficzny interfejs użytkownika</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="summary.html"
                        title="next chapter">Praktyczna aplikacja</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/gui2.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="summary.html" title="Praktyczna aplikacja"
             >next</a> |</li>
        <li class="right" >
          <a href="gui.html" title="Graficzny interfejs użytkownika"
             >previous</a> |</li>
        <li><a href="index.html">Java krok po kroku 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Centrum Edukacji Obywatelskiej (http://www.ceo.org.pl/).
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>